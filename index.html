<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Neon City Builder</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="app-container">
        <!-- Top HUD (Money & Income) -->
        <header class="hud-panel">
            <div class="logo">
                <i class="fa-solid fa-city"></i>
            </div>
            <div class="stats-container">
                <div class="stat-item money">
                    <span class="stat-value">¥<span id="money-display">0</span></span>
                </div>
                <div class="stat-item income">
                    <span class="stat-label">/sec</span>
                    <span class="stat-value">¥<span id="income-rate-display">0</span></span>
                </div>
            </div>
            <button id="menu-btn" class="icon-btn"><i class="fa-solid fa-bars"></i></button>
        </header>

        <!-- Main Viewport (Grid) -->
        <main class="viewport">
            <div class="grid-outer-wrapper">
                <div id="grid" class="game-grid">
                    <!-- Grid cells generated by JS -->
                </div>
            </div>

            <!-- Toast Message Area -->
            <div id="status-message" class="toast hidden"></div>
        </main>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <button id="nav-work" class="nav-item active" data-target="panel-work">
                <i class="fa-solid fa-briefcase"></i>
                <span>Work</span>
            </button>
            <button id="nav-build" class="nav-item" data-target="panel-build">
                <i class="fa-solid fa-hammer"></i>
                <span>Build</span>
            </button>
            <button id="nav-research" class="nav-item" data-target="panel-research">
                <i class="fa-solid fa-flask"></i>
                <span>Tech</span>
            </button>
        </nav>

        <!-- Panels / Modals -->
        <div id="panel-container" class="panel-container hidden">
            <div class="panel-overlay" id="panel-overlay"></div>

            <!-- Work Panel -->
            <div id="panel-work" class="bottom-panel hidden">
                <div class="panel-header">
                    <h3>Work</h3>
                    <button class="close-panel"><i class="fa-solid fa-chevron-down"></i></button>
                </div>
                <div class="panel-content-scroll">
                    <button id="work-btn" class="btn primary-btn large-btn">
                        <div class="btn-content">
                            <i class="fa-solid fa-coins"></i>
                            <span>Work (+10¥)</span>
                        </div>
                    </button>

                    <div class="upgrades-section">
                        <h4>Upgrades</h4>
                        <div id="click-upgrade-container">
                            <!-- Will be rendered by JS if possible, or keep separate -->
                            <!-- For now, click upgrade is in Research tree, let's keep it there or link it -->
                            <p class="hint-text">Go to Tech tab for efficiency upgrades.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Build Panel -->
            <div id="panel-build" class="bottom-panel hidden">
                <div class="panel-header">
                    <h3>Construction</h3>
                    <button class="close-panel"><i class="fa-solid fa-chevron-down"></i></button>
                </div>
                <div class="panel-content-scroll">
                    <div class="shop-grid">
                        <button id="buy-factory-small-btn" class="btn shop-btn factory-small">
                            <i class="fa-solid fa-industry"></i>
                            <div class="shop-btn-info">
                                <span class="btn-text">Small Factory</span>
                                <span class="btn-cost">100¥</span>
                            </div>
                        </button>
                        <button id="buy-supply-depot-btn" class="btn shop-btn supply-depot">
                            <i class="fa-solid fa-warehouse"></i>
                            <div class="shop-btn-info">
                                <span class="btn-text">Supply Depot</span>
                                <span class="btn-cost">500¥</span>
                            </div>
                        </button>
                        <button id="buy-factory-large-btn" class="btn shop-btn factory-large">
                            <i class="fa-solid fa-city"></i>
                            <div class="shop-btn-info">
                                <span class="btn-text">High-Tech Factory</span>
                                <span class="btn-cost">2,000¥</span>
                            </div>
                        </button>
                        <button id="buy-power-plant-btn" class="btn shop-btn power-plant">
                            <i class="fa-solid fa-bolt"></i>
                            <div class="shop-btn-info">
                                <span class="btn-text">Power Plant</span>
                                <span class="btn-cost">5,000¥</span>
                            </div>
                        </button>
                    </div>

                    <div class="mgmt-section">
                        <button id="expand-btn" class="btn secondary-btn full-width">
                            <i class="fa-solid fa-expand"></i> Expand City
                        </button>
                    </div>
                </div>
            </div>

            <!-- Research Panel (Actually re-using existing modal logic or new panel?) -->
            <!-- Let's use the new panel style for consistency, OR keep full modal.
                 User asked for "Select from bottom".
                 Let's make Research a bottom panel too. -->
            <div id="panel-research" class="bottom-panel hidden">
                <div class="panel-header">
                    <h3>Technologies</h3>
                    <button class="close-panel"><i class="fa-solid fa-chevron-down"></i></button>
                </div>
                <div class="panel-content-scroll">
                    <div id="skill-tree-container" class="skill-tree-container">
                        <!-- Skills injected here -->
                    </div>
                    <button id="reset-skills-btn" class="btn outline-btn small-btn" style="margin-top: 20px;">
                        <i class="fa-solid fa-rotate-left"></i> Respec (10% Fee)
                    </button>
                </div>
            </div>

        </div>

        <!-- Menu Modal (Settings/Reset) -->
        <div id="menu-modal" class="modal hidden">
            <div class="modal-content small-modal">
                <div class="modal-header">
                    <h2>Menu</h2>
                    <button id="close-menu-btn" class="close-btn">&times;</button>
                </div>
                <div class="modal-body">
                    <button id="repair-btn" class="btn danger-btn full-width">
                        <i class="fa-solid fa-screwdriver-wrench"></i> Repair All
                        <span id="repair-cost" class="small-cost">(0¥)</span>
                    </button>
                    <hr>
                    <button id="reset-btn" class="btn text-btn full-width">
                        <i class="fa-solid fa-trash-can"></i> Reset Data
                    </button>
                </div>
            </div>
        </div>

    </div>

    <!-- Legacy Skill Modal removed, using panel-research now -->

    <script src="script.js"></script>
</body>

</html>